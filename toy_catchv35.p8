pico-8 cartridge // http://www.pico-8.com
version 35
__lua__
--main variables
is_playing=true
start=300
basket_sprite=1

--player vars
player_sprite=2
player_shoes=3
player_x=64
player_y=108

--toy vars
toys={}
toys_start=16
toys_count=6
toys_interval=16
gravity=1

--game vars
level=1
points=0

--initialize the game
function _init()

 --how to add in toys
 -- per interval, randomized
	for i=1,level do
		toy={
				sprite=flr(rnd(toys_count)+toys_start),
				x=flr(rnd(120)+5),
				y=i*(-toys_interval)
		} 
		add(toys,toy)
	end
end

--updates game
-- 30 times per second
function _update()

 --move character left
	if btn(0) then
     if player_x < -.5 then
      player_x = 0 end

      player_x-=2.5

      end
    --move character right
    if btn(1) then 
      if player_x > 118 then
      player_x = 118 end
      player_x+=2.5 
 end
 
 --toy gravity and catching
	for toy in all(toys) do
		toy.y+=gravity
		
		--if they catch the toy
		if toy.y+4>player_y-8
		and toy.y+4<player_y
		and toy.x+4>player_x
		and toy.x+4<player_x+8 then
			points+=1
			del(toys,toy)
		end
		
		--if toy hits the floor
			if toy.y>100 then
				del(toys,toy)
				points-=1
			end
	end
	
	--if there are no toys- more fall
	if #toys==0 then
		level+=1
		_init()
	end

 --game state condition
 if is_playing then
   --check win condition
   if points==15 then
     is_playing=false
   end
 
   --check lose condition
   if points==-1 then
   	 is_playing=false
   end
 --reset the game
 else
  	if btnp(4) then
 	  	is_playing=true
 	  	points=0
 	  	level=1
     if toy.y<100 then
				   del(toys,toy)
		  	end 		
	  end
 end
end

--draw map, sprites, words
function _draw()
  --clear screen
	 cls()
	
	 --draw map -> bedroom
	 draw_map()
	
	 --if we're still playing
 	if is_playing then
    spr(player_sprite,player_x,player_y)
    spr(basket_sprite,player_x,player_y-8)
    spr(player_shoes,player_x,player_y+8)

    --draws the random toy
	   for toy in all(toys) do
		    spr(toy.sprite,toy.x,toy.y)
	   end
	
	   --if we just started
	   if start>0 then
      print("don't let your score drop\n",20,50,0)
      print("score="..points,50,58,0)
      start = start-1
    --been playing > 10 sec
    else
	    	print("score="..points,0)
	   end
	 --game ended (is_playing = f)
	 else
	   --print lose condtion
    if points == -1 then
      print('game over - press üÖæÔ∏è',20,50,0)
    end

    --print win condition
    if points == 15 then
      print('you win! - press üÖæÔ∏è',20,50,0)
    end
  end 
end

--draws logo
function logo()
  sfx(1)
  local t = 0
  while (t<190) do
    cls()
    if (t>124) then
    spr(32,55,68)
    elseif (t>60) then
    spr(32,55,68)
    elseif (t>28) then
    spr(32,65,68)
    elseif (t>13) then
    spr(32,75,68)
    else
    spr(32,85,68)
    end
    if (t>60) then
    spr(33,55,60)
    print("sky bison!",41,50,7)
    end
    flip() t+=1
  end
end

--call logo at start
logo()


-->8
--draw map
function draw_map()
 mapx = 0 
 mapy = 0
-- camera(mapx8,mapy8)
 map(0,0,0,0,128,64)
end
__gfx__
0000000044000044f088880f009999000000000077777777cccccccc40400404cccccccccccccccc000000000000000000000000000000000000000000000000
00000000f444444f8888888800aaaa000000000066666666cccccccc40400404c1c69cccccc00ccc000000000000000000000000000000000000000000000000
00700700ff4444fff0f1f10f001111000000000077777777cccc777c40404404c1369eacccc700cc000000000000000000000000000000000000000000000000
00077000f000000af0ffff0f001111000000000077777777ccc777cc4040400441369eecccc77cc4000000000000000000000000000000000000000000000000
00077000f000000f99feef99001111000000000066666666cccccccc4040400441369eeccc0000c4000000000000000000000000000000000000000000000000
00700700f000000f99999999001111000000000077777777cccccccc404040444444444444444444000000000000000000000000000000000000000000000000
00000000f000000ff999999f005555000000000077777777cc77cccc00404040cc77cccccc77cccc000000000000000000000000000000000000000000000000
00000000f000000f00999900005555000000000077777777c77ccccc04404040c77cccccc77ccccc000000000000000000000000000000000000000000000000
004444000002200000888800000ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000ff000000f2000004ff00000eaae00000000000003b30000000000000000000000000000000000000000000000000000000000000000000000000000000000
00a75a0000bbbb000477a70000affa0000000000000ff03000000000000000000000000000000000000000000000000000000000000000000000000000000000
00a570a00f7b270007077f700eeeeee00445654003b333b000000000000000000000000000000000000000000000000000000000000000000000000000000000
00faa0f000077f000f011000070eef700f4656440003b00000000000000000000000000000000000000000000000000000000000000000000000000000000000
0004400000bbbb00000750000ffee000fff56544000b300000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011000000770000005700000e77e0000f000f40003300000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011000000bb000000440000e7ee7e0044004400033330000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000088088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
50500000888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
fff4ff00088888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1f1f4ff0008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
555fff44000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f04000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0606060606060606060606060606060600000303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000300030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000300030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000000030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060608090606060600000003030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000003000303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000000030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060809060606060606060606060600000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000000030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0909090909090909090909090909090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000905000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00100000000000105003050090500d0500f0500f0500e0500f050120501a0501c05012000280502d0501e00000000000000000000000000000000000000000000000000000000000000000000000000000000000
